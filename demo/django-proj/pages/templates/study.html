{% extends 'base.html' %}
{% load i18n %}
{% load card_template_parser %}

{% block content %}
	<section id="front" class="card one-sided-card">
		<div class="card-front fade-in">
			{% for template in deck.f_template|parse_card_template_fields %}
			{% with card|parse_card_template:template as card %}
			<span class="card-field {{ card.class }}">{{ card.field }}</span>
			{% endwith %}
			{% endfor %}
		</div>
	</section>
	<section id="back">
		{% if answered %}
		<div class="card one-sided-card" {% if answered %}class="is-muted"{% endif %}>
			<div class="card-back">
				{% for template in deck.b_template|parse_card_template_fields %}
				{% with card|parse_card_template:template as card %}
				<span class="card-field {{ card.class }}">{{ card.field }}</span>
				{% endwith %}
				{% endfor %}
			</div>
		</div>
		{% endif %}
		
		<form method="post" action="{{ request.get_full_path }}" class="{{ answered|yesno:"study-levels,is-muted" }}">
			{% csrf_token %}
			{# @TODO Log start time #}
			<input type="hidden" name="use-time" value="{{ use_time }}" />
			<input type="hidden" name="time-limit" value="{{ time_limit }}" />
			<input type="hidden" name="randomize" value="{{ randomize }}" />
			<input type="hidden" name="use-reverse" value="{{ use_reverse }}" />
			
			<input type="hidden" name="order" value="{{ card.order }}" />
			<input type="hidden" name="current-item" value="{{ current_item }}" />
			<input type="hidden" name="last-item" value="{{ last_item }}" />
			<input type="hidden" name="randomize" value="{{ randomize }}" />
			<input type="hidden" name="random-queue" value="{{ random_queue }}" />
			<input type="hidden" name="repeat-queue" value="{{ repeat_queue }}" />
			
			{% if answered %}
			<input type="submit" name="study-l0" value="Repeat" class="btn bad-btn large-btn" id="study-l0" />
			<input type="submit" name="study-l1" value="Bad" class="btn good-btn large-btn" id="study-l1" />
			<input type="submit" name="study-l2" value="Good" class="btn good-btn large-btn" id="study-l2" />
			<input type="submit" name="study-l3" value="Excellent" class="btn good-btn large-btn" id="study-l3" />
			{% else %}
			<span class="input-btn mega-btn" id="study-show-answer"><input type="submit" name="show-answer" value="{% trans "Show Answer" %}" /></span>
			{% endif %}
		</form>
		
		<div class="study-status">
			<!-- @TODO Requires JS -->
			<!-- <span class="study-time">0:07</span>  -->
			<span class="study-progress">{{ current_item }}/{{ last_item }}</span> 
			<!-- @TODO Requires JS -->
			<!-- <span class="study-repeats">1</span> -->
		</div>
	</section>
{% endblock %}

{# Remove the footer and search box on this page #}
{% block searchbox %}{% endblock %}
{% block footer %}{% endblock %}

{% block extra_scripts %}
	{# @TODO card.js needs to be fixed and used here #}
	<script src="{{ STATIC_URL }}js/study.min.js"></script>
{% endblock %}